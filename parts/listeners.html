
{% include scripts/scripts-common.html %}

<script>
// vim: ts=3

var CGI = {};      // CGI parameters from URL
var MENUDATA = [];
var MENUDATA_BOTH = [];
var MENUDATA_AUTOMATIC = [];
var MENUDATA_MANUAL = [];
var ID = "";
var NAME = "";


//////////////////////////////
//
// DOMContentLoaded event listener --
//

document.addEventListener("DOMContentLoaded", function () {
	CGI = GetCgiParameters();
	if (CGI.id) {
		ID = CGI.id;
	}
	if (location.hash) {
		NAME = location.hash.replace(/[^A-Za-z]/g, "");
	}

	// Create URL for work index to download:
	var sid = "1U4Z-NeU2FGk_qNq6BwXeSVN-p8AnZsWbRHGo5fk3f3A"
	var gid = "0";
	var url = "https://docs.google.com/spreadsheets/d/";
	url += sid + "/export?gid=" + gid + "&format=tsv";

	var request = new XMLHttpRequest();
	request.addEventListener("load", function () {
		MENUDATA_BOTH = PrepareMenuIndexBoth(this.responseText)
		MENUDATA_AUTOMATIC = PrepareMenuIndexAutomatic(this.responseText)
		MENUDATA_MANUAL = PrepareMenuIndexManual(this.responseText)
		MENUDATA = MENUDATA_BOTH;
		LIST = LIST_BOTH;
		SHORTCUTS = SHORTCUTS_BOTH;
		doAction(MENUDATA);
	});
	request.open("GET", url);
	request.send();
});



//////////////////////////////
//
// doAction --
//

function doAction(menudata) {
	doSearch();
}


</script>



